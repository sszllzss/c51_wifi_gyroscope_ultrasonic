C51 COMPILER V9.59.0.0   GPIO                                                              03/06/2021 23:00:12 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE GPIO
OBJECT MODULE PLACED IN .\out\gpio.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\device\gpio.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\application;..\devic
                    -e) DEBUG OBJECTEXTEND PRINT(.\out\Listings\gpio.lst) OBJECT(.\out\gpio.obj)

line level    source

   1          #include "gpio.h"
   2          
   3          
   4          
   5          
   6          /**
   7          * 初始化IO口.
   8          * @parameter GPIO GPIO组
   9          * @parameter Pin 端口:GPIO_Pin_All\GPIO_Pin_0~7
  10          * @parameter Mode IO模式:GPIO_PullUp,GPIO_HighZ,GPIO_OUT_OD,GPIO_OUT_PP
  11          * @return 操作结果 0 成功 1空操作（GPIO错误） 1 MODE错误
  12          */
  13          uint8_t GPIO_Inilize(uint8_t GPIO, uint8_t Pin,uint8_t  Mode)
  14          {
  15   1              if(GPIO > GPIO_P7)                              return 1;       //空操作
  16   1              if(Mode > GPIO_OUT_PP)  return 2;       //错误
  17   1              if(GPIO == GPIO_P0)
  18   1              {
  19   2                      if(Mode == GPIO_PullUp)         P0M1 &= ~Pin,   P0M0 &= ~Pin;    //上拉准双向口
  20   2                      if(Mode == GPIO_HighZ)          P0M1 |=  Pin,   P0M0 &= ~Pin;    //浮空输入
  21   2                      if(Mode == GPIO_OUT_OD)         P0M1 |=  Pin,   P0M0 |=  Pin;    //开漏输出
  22   2                      if(Mode == GPIO_OUT_PP)         P0M1 &= ~Pin,   P0M0 |=  Pin;    //推挽输出
  23   2              }
  24   1              else if(GPIO == GPIO_P1)
  25   1              {
  26   2                      if(Mode == GPIO_PullUp)         P1M1 &= ~Pin,   P1M0 &= ~Pin;    //上拉准双向口
  27   2                      if(Mode == GPIO_HighZ)          P1M1 |=  Pin,   P1M0 &= ~Pin;    //浮空输入
  28   2                      if(Mode == GPIO_OUT_OD)         P1M1 |=  Pin,   P1M0 |=  Pin;    //开漏输出
  29   2                      if(Mode == GPIO_OUT_PP)         P1M1 &= ~Pin,   P1M0 |=  Pin;    //推挽输出
  30   2              }
  31   1              else if(GPIO == GPIO_P2)
  32   1              {
  33   2                      if(Mode == GPIO_PullUp)         P2M1 &= ~Pin,   P2M0 &= ~Pin;    //上拉准双向口
  34   2                      if(Mode == GPIO_HighZ)          P2M1 |=  Pin,   P2M0 &= ~Pin;    //浮空输入
  35   2                      if(Mode == GPIO_OUT_OD)         P2M1 |=  Pin,   P2M0 |=  Pin;    //开漏输出
  36   2                      if(Mode == GPIO_OUT_PP)         P2M1 &= ~Pin,   P2M0 |=  Pin;    //推挽输出
  37   2              }
  38   1              else if(GPIO == GPIO_P3)
  39   1              {
  40   2                      if(Mode == GPIO_PullUp)         P3M1 &= ~Pin,   P3M0 &= ~Pin;    //上拉准双向口
  41   2                      if(Mode == GPIO_HighZ)          P3M1 |=  Pin,   P3M0 &= ~Pin;    //浮空输入
  42   2                      if(Mode == GPIO_OUT_OD)         P3M1 |=  Pin,   P3M0 |=  Pin;    //开漏输出
  43   2                      if(Mode == GPIO_OUT_PP)         P3M1 &= ~Pin,   P3M0 |=  Pin;    //推挽输出
  44   2              }
  45   1              else if(GPIO == GPIO_P4)
  46   1              {
  47   2                      if(Mode == GPIO_PullUp)         P4M1 &= ~Pin,   P4M0 &= ~Pin;    //上拉准双向口
  48   2                      if(Mode == GPIO_HighZ)          P4M1 |=  Pin,   P4M0 &= ~Pin;    //浮空输入
  49   2                      if(Mode == GPIO_OUT_OD)         P4M1 |=  Pin,   P4M0 |=  Pin;    //开漏输出
  50   2                      if(Mode == GPIO_OUT_PP)         P4M1 &= ~Pin,   P4M0 |=  Pin;    //推挽输出
  51   2              }
  52   1              else if(GPIO == GPIO_P5)
  53   1              {
  54   2                      if(Mode == GPIO_PullUp)         P5M1 &= ~Pin,   P5M0 &= ~Pin;    //上拉准双向口
C51 COMPILER V9.59.0.0   GPIO                                                              03/06/2021 23:00:12 PAGE 2   

  55   2                      if(Mode == GPIO_HighZ)          P5M1 |=  Pin,   P5M0 &= ~Pin;    //浮空输入
  56   2                      if(Mode == GPIO_OUT_OD)         P5M1 |=  Pin,   P5M0 |=  Pin;    //开漏输出
  57   2                      if(Mode == GPIO_OUT_PP)         P5M1 &= ~Pin,   P5M0 |=  Pin;    //推挽输出
  58   2              }
  59   1              else if(GPIO == GPIO_P6)
  60   1              {
  61   2                      if(Mode == GPIO_PullUp)         P6M1 &= ~Pin,   P6M0 &= ~Pin;    //上拉准双向口
  62   2                      if(Mode == GPIO_HighZ)          P6M1 |=  Pin,   P6M0 &= ~Pin;    //浮空输入
  63   2                      if(Mode == GPIO_OUT_OD)         P6M1 |=  Pin,   P6M0 |=  Pin;    //开漏输出
  64   2                      if(Mode == GPIO_OUT_PP)         P6M1 &= ~Pin,   P6M0 |=  Pin;    //推挽输出
  65   2              }
  66   1              else if(GPIO == GPIO_P7)
  67   1              {
  68   2                      if(Mode == GPIO_PullUp)         P7M1 &= ~Pin,   P7M0 &= ~Pin;    //上拉准双向口
  69   2                      if(Mode == GPIO_HighZ)          P7M1 |=  Pin,   P7M0 &= ~Pin;    //浮空输入
  70   2                      if(Mode == GPIO_OUT_OD)         P7M1 |=  Pin,   P7M0 |=  Pin;    //开漏输出
  71   2                      if(Mode == GPIO_OUT_PP)         P7M1 &= ~Pin,   P7M0 |=  Pin;    //推挽输出
  72   2              }
  73   1              return 0;       //成功
  74   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    453    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
